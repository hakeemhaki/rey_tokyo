!function(e){"use strict";var t={class:"is-opened",term:"",$searchPanel:e(".js-rey-ajaxSearch"),_request:!1,init:function(){e.reyHelpers.params.ajax_search&&(this.$postType=e('[name="post_type"]',this.$searchPanel),this.$postType.length&&(this.$searchField=e("input[type='search']",this.$searchPanel),this.panel_HTML=wp.template("reySearchPanel"),this.$results=e(".js-rey-searchResults",this.$searchPanel),this.params=e.reyHelpers.params,this.$catList=e(".rey-searchForm-catList",this.$searchPanel),this.events()))},events:function(){var t=this,s=function(e){t._request&&t._request.abort(),t.$searchPanel.addClass("--loading"),t.doSearch(e)};this.$searchField.on("search keyup change paste",e.reyHelpers.debounce((function(){var a=e(this).val();""!==a&&a.length>=t.params.js_params.ajax_search_letter_count?""!=t.term&&t.term==a||s(a):t.printSearchResults(),t.term=a}),1e3)),this.$postType.on("change",(function(s){var a=e(this);t.term="",t.$searchField.trigger("search"),e(".rey-searchForm-postType > span",t.$searchPanel).text(e("option:selected",this).text()),t.$catList.length&&("product"===a.val()?(t.$catList.parent().show(),t.$catList.removeAttr("disabled")):(t.$catList.parent().hide(),t.$catList.attr("disabled","disabled")))})),this.$catList.on("change",(function(a){t.term&&s(t.term),e(this).siblings("span").text(e("option:selected",this).text())})),e(".rey-searchPanel__suggestions button").on("click",(function(s){s.preventDefault(),t.$searchField.val(e(this).text()),t.$searchField.trigger("change")}))},doSearch:function(t){var s=this;if(void 0!==this.params.ajaxurl&&void 0!==this.params.search_texts){var a={s:t,post_type:s.$postType.val(),action:"reycore_ajax_search"};this.$catList.length&&(a.product_cat=this.$catList.val()),a.extra_data=this.$searchField.closest("form").serialize()||"",this._request=e.post({url:this.params.ajaxurl,cache:!1,data:a,success:function(e){var t=[];e&&e.success&&e.data.total_count&&0!==parseInt(e.data.total_count)&&(t=e.data.items),s.$searchPanel.addClass("--has-results"),s.printSearchResults(t),s._request=!1},error:function(e,t,a){s._request=!1}})}},printSearchResults:function(t){var s="";e.reyHelpers.isArray(t)?(s=t.length?this.panel_HTML({items:t,only_title:this.params.ajax_search_only_title}):"<div class='rey-searchResults-message'>"+this.params.search_texts.NO_RESULTS+"</div>",this.$searchPanel.removeClass("--loading")):this.$searchPanel.removeClass("--has-results");var a=this.$results.empty().removeClass("--visible").html(s);e(a).imagesLoaded((function(){e(a).addClass("--visible")}))}};e(document).on("reycore/woocommerce/init",(function(e,s){t.init()}))}(jQuery);