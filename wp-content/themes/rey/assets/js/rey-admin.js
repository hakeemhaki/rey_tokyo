!function(o){"use strict";var e=o(".rey-dashboard-main");void 0!==o.fn.masonry&&e.masonry({itemSelector:".rey-dashBox",originLeft:!o("body.rtl").length});var n=function(e,r,a){if(e&&r&&a){var s={value:r,expires_at:(new Date).getTime()+a/1};localStorage.setItem(e.toString(),JSON.stringify(s))}},t=function(e){if(!e)return null;var r=JSON.parse(localStorage.getItem(e.toString()));if(null!==r){if(!(null!==r.expires_at&&r.expires_at<(new Date).getTime()))return r.value;localStorage.removeItem(e.toString())}return null};o(".js-storeNotice").each(function(e,r){var a=o(r),s="rey-notice-"+a.attr("data-from");t(s)&&a.hide(),o(".notice-dismiss",a).on("click",function(e){a.hide(),n(s,!0,432e5)})}),o('<li class="rey-refresh-plugins"><a href="'+reyAdminParams.refresh_plugins_url+'">'+reyAdminParams.refresh_plugins_text+"</a></li>").appendTo(o(".tgmpa.wrap .subsubsub")),o("form#tgmpa-plugins .wp-list-table tbody tr").each(function(e,r){var a=o(r),s=a.find("td.type.column-type"),n=a.find(".rey-tgmpaNeedReg");s.length&&"Required"===s.text()&&a.addClass("--required"),n.length&&a.find('input[type="checkbox"]').prop("disabled",!0)});var i=function(){void 0!==o.fn.masonry&&e.masonry("layout")},r=o('body[class*="_page_rey-settings"]'),a=o("#postbox-container-2",r);o("#publishing-action",r).detach().prependTo(a);o(".js-dashDeregister").on("click",function(e){e.preventDefault();var s=o(this);s.addClass("rey-adminBtn--disabled"),o.ajax({method:"get",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_dashboard_deregister",security:reyAdminParams.ajax_dashboard_nonce},success:function(e){e&&(e.success&&1==e.success?(s.text(reyAdminParams.dashboard_strings.deregister_success),setTimeout(function(){location.reload()},2e3)):s.removeClass("rey-adminBtn--disabled"))},error:function(e,r,a){s.removeClass("rey-adminBtn--disabled"),console.error(e),console.error(r),console.error(a)}})}),o(".js-dashBox-registerForm").on("submit",function(e){e.preventDefault();var r=o(this),s=r.find(".rey-adminBtn"),a=o('input[name="rey_purchase_code"]',r).val();o(".rWizard-response").remove(),s.addClass("rey-adminBtn--disabled --loading"),o.ajax({method:"post",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_dashboard_register",security:reyAdminParams.ajax_dashboard_nonce,rey_purchase_code:a.trim(),rey_email_address:o('input[name="rey_email_address"]',r).val(),rey_subscribe_newsletter:o('input[name="rey_subscribe_newsletter"]',r).val()},success:function(e){s.removeClass("--loading"),e&&(e.success&&1==e.success?(s.text(reyAdminParams.dashboard_strings.reloading_text),setTimeout(function(){location.reload()},2e3)):s.removeClass("rey-adminBtn--disabled").text(reyAdminParams.dashboard_strings.default_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+e.data+"</p>"))},error:function(e,r,a){s.removeClass("rey-adminBtn--disabled").removeClass("--loading").text(reyAdminParams.dashboard_strings.default_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+reyAdminParams.dashboard_strings.something_went_wrong+"</p>"),console.error(e),console.error(r),console.error(a)}})});var d=function(e){var r=/{("success"[^}]+)}/g.exec(e);return!(!r||!r.length)&&JSON.parse(r[0])};o(".js-dashBox-installRequired").on("click",function(e){e.preventDefault();var s=o(this);s.addClass("rey-adminBtn--disabled").text(reyAdminParams.dashboard_strings.installing_btn_text),o(".reyAdmin-reqPlugin.--inactive:not(.--uninstallable)",s.closest(".rey-dashBox-content")).addClass("--is-installing"),o(".reyAdmin-response").remove();var r=new URL(window.location.href).searchParams.get("page")||"",n=function(){o.ajax({method:"get",url:reyAdminParams.ajax_url,dataType:"text",cache:!1,data:{action:"rey_dashboard_install_plugins",security:reyAdminParams.ajax_dashboard_nonce,page:r},success:function(e){i();var r=d(e);if(r)if(r.success&&!0===r.success&&!1!==r.data){var a=s.closest(".rey-dashBox-content");o(".reyAdmin-reqPlugin[data-slug='"+r.data+"']",a).removeClass("--is-installing --inactive").addClass("--is-active"),n()}else s.text(reyAdminParams.dashboard_strings.reloading_text),setTimeout(function(){location.reload()},2e3);else s.text(reyAdminParams.dashboard_strings.default_install_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+r.data+"</p>")},error:function(e,r,a){i(),s.text(reyAdminParams.dashboard_strings.default_install_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+reyAdminParams.dashboard_strings.something_went_wrong+"</p>"),console.error(e),console.error(r),console.error(a)}})};n()}),o(".js-subscribeNewsletterForm").on("submit",function(e){e.preventDefault();var r=o(this),s=r.find(".rey-adminBtn");o(".rWizard-response").remove(),s.addClass("rey-adminBtn--disabled --loading"),o.ajax({method:"post",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_dashboard_newsletter_subscribe",security:reyAdminParams.ajax_dashboard_nonce,rey_email_address:o('input[name="rey_email_address"]',r).val()},success:function(e){s.removeClass("--loading"),e&&(e.success&&1==e.success?(s.text(reyAdminParams.dashboard_strings.reloading_text),setTimeout(function(){location.reload()},2e3)):s.removeClass("rey-adminBtn--disabled").text(reyAdminParams.dashboard_strings.subscribe_default_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+e.data+"</p>"))},error:function(e,r,a){s.removeClass("rey-adminBtn--disabled").removeClass("--loading").text(reyAdminParams.dashboard_strings.subscribe_default_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+reyAdminParams.dashboard_strings.something_went_wrong+"</p>"),console.error(e),console.error(r),console.error(a)}})}),o(".js-installChild").on("click",function(e){e.preventDefault();var s=o(this);s.addClass("rey-adminBtn--disabled --loading"),o.ajax({method:"post",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_dashboard_install_child",security:reyAdminParams.ajax_dashboard_nonce},success:function(e){s.removeClass("--loading"),e&&e.success&&(s.text(reyAdminParams.dashboard_strings.copying_settings),o.ajax({method:"post",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_dashboard_migrate_opts_child",security:reyAdminParams.ajax_dashboard_nonce},success:function(e){s.removeClass("--loading"),e&&e.success&&(s.text(reyAdminParams.dashboard_strings.reloading_text),setTimeout(function(){location.reload()},2e3))}}))},error:function(e,r,a){s.removeClass("rey-adminBtn--disabled").removeClass("--loading").text(reyAdminParams.dashboard_strings.installing_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+reyAdminParams.dashboard_strings.something_went_wrong+"</p>"),console.error(e),console.error(r),console.error(a)}})}),o(".js-childCopySettings").on("click",function(e){e.preventDefault(),o(this).addClass("rey-adminBtn--disabled --loading")}),o("input#rey-purchase-code").on("change",function(e){this.value=this.value.replace(/\s+/g,"")}),o("input#rey-purchase-code").on("keyup",function(e){32==e.keyCode&&(this.value=this.value.replace(/\s+/g,""))});var s=o('body[class*="_page_rey-setup-wizard"]'),l=o(".rey-wizard-wrapperInner",s),c=o(".rWizard-step",s),m=o(".js-rWizard-registrationForm",s),u=o(".rey-adminBtn.rey-adminBtn-primary",m),_=o(".js-skipWizard",s),y=function(e,r){c.removeClass("--active"),c.eq(e).fadeOut(300),c.eq(r).addClass("--active"),l.height(c.eq(r).outerHeight())},g=o(".rWizard-step--1.--registered",s).length?1:0;1===g&&(g=o(".rWizard-step--2.--plugins-installed",s).length?2:1),c.eq(g).addClass("--active"),l.height(c.eq(g).outerHeight()).css("opacity",1),m.on("submit",function(e){e.preventDefault(),o(".rWizard-response").remove(),u.addClass("--loading").text(reyAdminParams.wizard_strings.registering_btn_text),o.ajax({method:"post",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_register_purchase_code",security:reyAdminParams.ajax_wizard_nonce,rey_purchase_code:o('input[name="rey_purchase_code"]',m).val(),rey_email_address:o('input[name="rey_email_address"]',m).val(),rey_subscribe_newsletter:o('input[name="rey_subscribe_newsletter"]',m).val()},success:function(e){if(u.removeClass("--loading"),e)if(e.success&&1==e.success){var r=o(".js-reyAdmin-reqPlugins");r.addClass("--loading"),o.ajax({method:"get",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_wizard_get_required_plugins_markup",security:reyAdminParams.ajax_wizard_nonce},success:function(e){e.success&&1==e.success&&r.empty().html(e.data),r.removeClass("--loading"),y(0,1)},error:function(e,r,a){console.error(e),console.error(r),console.error(a)}})}else u.text(reyAdminParams.wizard_strings.default_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+e.data+"</p>")},error:function(e,r,a){u.removeClass("--loading").text(reyAdminParams.wizard_strings.default_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+reyAdminParams.wizard_strings.something_went_wrong+"</p>"),console.error(e),console.error(r),console.error(a)}})}),o(".js-skipRegistration",s).on("click",function(e){e.preventDefault(),y(0,1),l.addClass("--skipped-registration")}),o(".js-backRegistration",s).on("click",function(e){e.preventDefault(),c.removeClass("--active"),c.eq(0).addClass("--active").fadeIn(),l.height(c.eq(0).outerHeight()).removeClass("--skipped-registration")}),o(".js-rWizard-btnStep-2",s).on("click",function(e){e.preventDefault();var s=o(this),a=s.closest(".rWizard-step"),r=o("#wizardInstallChild").prop("checked");s.addClass("rey-adminBtn--disabled").text(reyAdminParams.wizard_strings.installing_btn_text),r&&(o("#wizardInstallChild").prop("disabled"),o(".rWizard-installChild",a).addClass("--is-installing")),o(".reyAdmin-reqPlugin.--inactive:not(.--uninstallable)",a).addClass("--is-installing"),o(".reyAdmin-response").remove();var n=new URL(window.location.href).searchParams.get("page")||"",t=function(){o.ajax({method:"get",url:reyAdminParams.ajax_url,cache:!1,dataType:"text",data:{action:"rey_wizard_install_plugins",security:reyAdminParams.ajax_wizard_nonce,page:n,child_theme:r},success:function(e){var r=d(e);r?r.success&&!0===r.success&&!1!==r.data&&"child_theme"!==r.data?(o(".reyAdmin-reqPlugin[data-slug='"+r.data+"']",a).removeClass("--is-installing --inactive").addClass("--is-active"),t()):(y(1,2),o.ajax({method:"get",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_wizard_skip",security:reyAdminParams.ajax_wizard_nonce},success:function(e){e&&e.success&&1==e.success&&_.css("opacity",0)},error:function(e,r,a){console.error(e),console.error(r),console.error(a)}}),o.ajax({method:"get",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_wizard_enable_child_theme",security:reyAdminParams.ajax_wizard_nonce},error:function(e,r,a){console.error(e),console.error(r),console.error(a)}})):s.text(reyAdminParams.wizard_strings.default_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+r.data+"</p>")},error:function(e,r,a){s.text(reyAdminParams.wizard_strings.default_install_btn_text).parent().before("<p class='reyAdmin-response reyAdmin-notice --error'>"+reyAdminParams.wizard_strings.something_went_wrong+"</p>"),console.error(e),console.error(r),console.error(a)}})};t()}),_.on("click",function(e){e.preventDefault();var r=o(this);r.addClass("rey-adminBtn--disabled --loading"),o.ajax({method:"get",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_wizard_skip",security:reyAdminParams.ajax_wizard_nonce},success:function(e){e&&e.success&&1==e.success&&(r.text(reyAdminParams.wizard_strings.skipping_success),setTimeout(function(){window.location.href=reyAdminParams.dashboard_url},2e3))},error:function(e,r,a){console.error(e),console.error(r),console.error(a)}})}),o("#dashbox-search-kb").on("keyup",function(e){if(13==e.keyCode){var r=e.target.value.trim().replace(/ /g,"+");window.open("https://support.reytheme.com/?source=kb&s="+r,"_blank").focus()}});var p=!1;window.onbeforeunload=function(){if(p)return"Rolling back version is in progress! Please don't close window."},o(".js-dashRollback").each(function(e,r){var a=o(r),t=a.prev("select"),i=a.siblings(".js-dashResponse");t.on("change",function(e){e.target.value?a.removeClass("disabled"):a.addClass("disabled")}),a.on("click",function(e){e.preventDefault(),i.text("");var a=o(this),s=a.closest(".rey-versionsStatus"),r=JSON.parse(a.attr("data-settings")||"{}"),n=t.val();confirm("Are you sure you want to rollback "+r.name+" to version "+n+"?")&&(a.addClass("--loading"),s.addClass("--locked"),p=!0,o.ajax({method:"post",url:reyAdminParams.ajax_url,cache:!1,data:{action:"rey_rollback_version",security:reyAdminParams.ajax_rollback_nonce,key:r.key,version:n},success:function(e){if(e){var r;if(!e.success)return a.removeClass("--loading").addClass("disabled").text(reyAdminParams.rollback_strings.failed),void i.text("string"!=typeof(r=e.data)?r.join("\r\n"):r);s.removeClass("--locked"),a.removeClass("--loading").addClass("disabled").text(reyAdminParams.rollback_strings.skipping_success),setTimeout(function(){window.location.href=reyAdminParams.dashboard_url},2e3)}else i.text(reyAdminParams.rollback_strings.something_went_wrong)},error:function(e,r,a){console.error(e),console.error(r),console.error(a)}}))})})}(jQuery);